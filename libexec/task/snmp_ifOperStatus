#!/bin/sh
set -eu

if [ $# -ne 2 ]; then
  echo "usage: $0 <host> <interface>" >&2
  exit 1
fi

# Check the status of a network interface.
#
# returns:
#   - 1 when up
#   - 2 when down
#   - 3 when testing

SNMP_HOST=$1
SNMP_VERSION=${SNMP_VERSION:-2c}
SNMP_COMMUNITY=${SNMP_COMMUNITY:-public}

snmp get                 \
  -v "${SNMP_VERSION}"   \
  -c "${SNMP_COMMUNITY}" \
  "${SNMP_HOST}"         \
  "ifOperStatus.$2"      \
  | awk '{ print $NF }'
